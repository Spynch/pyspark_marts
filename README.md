# pyspark_marts

Этот репозиторий содержит два Jupyter Notebook'а, демонстрирующих генерацию 
тестовых данных и построение витрин с использованием Apache Spark.

## Состав

- **create_files.ipynb** – скрипт для генерации JSON‑файлов с данными.
- **data_marts.ipynb** – пример агрегации и объединения данных в итоговую витрину.

## Используемые инструменты

- **Python 3** и библиотека **PySpark** – основная среда обработки данных.
- **Apache Spark 3.1.1** – скачивается и настраивается прямо в ноутбуке.
- Дополнительные пакеты: `country_list`, `countryinfo`, `pdoc3` и др.
- Запуск предполагается в среде **Google Colab**, где выполняются команды `apt` 
  и монтирование Google Drive.

## Процесс работы

1. В `create_files.ipynb` разворачивается Spark, генерируется случайный набор
   "сырых" событий (информация о пользователях и их действиях), после чего
   данные сохраняются в JSON по дням.
2. В `data_marts.ipynb` созданные файлы читаются с помощью Spark, из них
   формируются отдельные таблицы‑витрины (data marts), которые затем
   связываются между собой. Итоговый DataFrame `main_marts` демонстрирует,
   как можно объединять данные по разным ключам и извлекать значения из
   структурированных полей.
